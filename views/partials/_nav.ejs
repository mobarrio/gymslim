<!-- 
  Barra de navegación dinámica.
  Se incluye en: list.ejs, horario.ejs, y todas las páginas de admin.
-->
<style>
  .main-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background-color: #ffffff;
    border-bottom: 1px solid #ddd;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    box-sizing: border-box; /* Asegura que el padding no afecte el width */
    z-index: 100;
  }
  .main-nav .nav-group { display: flex; align-items: center; gap: 15px; }
  .main-nav .nav-links { display: flex; align-items: center; gap: 15px; }
  .main-nav a { color: #007bff; text-decoration: none; }
  .main-nav .nav-email { color: #555; }
  .main-nav .nav-email strong { color: #000; }
  .main-nav .nav-email a { font-size: 12px; }
  .main-nav .admin-link { font-weight: bold; color: #dc3545; }

  /* --- NUEVO: Estilos para el selector de fecha --- */
  #nav-date-form {
    margin: 0;
  }
  #nav-date-select {
    font-family: inherit;
    font-size: 14px;
    padding: 5px 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #f9f9f9;
    cursor: pointer;
  }
  #nav-date-select:hover {
    border-color: #999;
  }
  /* --- Fin de nuevos estilos --- */
</style>

<nav class="main-nav">
  <div class="nav-group">
    <strong>GYMSLIM (Charly)</strong>
    
    <!-- --- REEMPLAZADO: Enlace de Horario por Selector --- -->
    <form action="/list" method="GET" id="nav-date-form">
      <select name="range_key" id="nav-date-select">
        <!-- 
          'locals.range_key' es pasado desde el controlador (appController)
          para saber qué opción marcar como seleccionada.
        -->
        <option value="" disabled <%= !locals.range_key ? "selected" : "" %>>
          Seleccionar rango...
        </option>
        <option value="today" <%= locals.range_key === 'today' ? "selected" : "" %>>
          Hoy
        </option>
        <option value="tomorrow" <%= locals.range_key === 'tomorrow' ? "selected" : "" %>>
          Mañana
        </option>
        <option value="this_week" <%= locals.range_key === 'this_week' ? "selected" : "" %>>
          Esta Semana
        </option>
        <option value="next_7" <%= locals.range_key === 'next_7' ? "selected" : "" %>>
          Próximos 7 Días
        </option>
        <option value="custom">
          Rango Personalizado...
        </option>
      </select>
      <!-- Botón oculto para que el form funcione sin JS (aunque onchange es JS) -->
      <button type="submit" style="display:none;"></button>
    </form>
    <!-- --- Fin del reemplazo --- -->

    <% if (user && user.isAdmin) { %>
      <a href="/admin" class="admin-link">Admin</a>
    <% } %>
  </div>

  <% if (user) { %>
    <div class="nav-links">
      <div class="nav-email">
        Email: <strong><%= activeBookingEmail || 'N/A' %></strong>
        (<a href="/admin/emails/select">[Cambiar]</a>)
      </div>
      <span><%= user.username %></span>
      <a href="/logout">Cerrar Sesión</a>
    </div>
  <% } %>
</nav>
